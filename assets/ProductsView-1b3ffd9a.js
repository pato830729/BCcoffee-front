import{b as v,r as k,k as B,S as f,D as q,c,d,e,n as u,F as D,m as C,w as M,t as n,f as a,v as b,h as p,I as m,J as S,l as N,M as $}from"./index-8da19006.js";new RegExp("\\b"+"arguments,await,break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,let,new,return,super,switch,throw,try,var,void,while,with,yield".split(",").join("\\b|\\b")+"\\b");const F={class:"admin_title_search"},J={class:"admin_title_addDelete"},L=e("h1",null,"商品管理",-1),T=e("i",{class:"fa-solid fa-circle-plus"},null,-1),E=e("div",{class:"search_container"},[e("input",{type:"text",class:"search_input",placeholder:"以訂單編號搜尋"}),e("button",{class:"admin_button button_search"},[e("i",{class:"fa-solid fa-magnifying-glass"}),u(" 搜尋 ")])],-1),I={class:"admin_table"},O=e("thead",null,[e("tr",null,[e("th",{class:"table_th_id"},"商品ID"),e("th",{class:"table_th_ell"},"名稱"),e("th",{class:"table_th_ell"},"價格"),e("th",{class:"table_th_short"},"分類"),e("th",{class:"table_th_short"},"狀態"),e("th",{class:"table_th_short"})])],-1),P={class:"table_td_id"},j={class:"table_td_ell"},A={class:"table_td_ell"},R={class:"table_th_short"},G={class:"table_th_short"},H=["onClick"],K=e("i",{class:"fa-solid fa-pen"},null,-1),Q={class:"dialogBg"},W=["onSubmit"],X={class:"dialogTitle"},Y=e("i",{class:"fa-solid fa-xmark"},null,-1),Z=[Y],ee={class:"dialog_container"},te={class:"text_container"},se={class:"dialog_container_left"},le={class:"adminDialogBg_inputStyle"},oe=e("label",{for:"dialog_name"},"名稱：",-1),ie={class:"input_position"},ae={key:0,class:"error_dialog"},ne={class:"adminDialogBg_checkbox"},re=e("label",{for:"dialog_checkbox_label"},"客製化：",-1),ce={key:0,class:"adminDialogBg_inputStyle"},de=e("label",{for:"dialog_price"},"大杯價格：",-1),ue={class:"input_position"},_e={key:0,class:"error_dialog"},pe={key:1,class:"error_dialog2"},me={key:1,class:"adminDialogBg_inputStyle"},ge=e("label",{for:"dialog_price"},"中杯價格：",-1),he={class:"input_position"},fe={key:0,class:"error_dialog"},be={key:1,class:"error_dialog2"},ye={class:"adminDialogBg_selectStyle"},ve=e("label",{for:"dialog_select_sell"},"狀態：",-1),ke=e("option",{value:"true",selected:""},"上架",-1),Be=e("option",{value:"false"},"下架",-1),xe=[ke,Be],Ve={class:"adminDialogBg_selectStyle"},De=e("label",{for:"dialog_select_category"},"商品分類：",-1),Se=e("option",{value:"latte",selected:""},"拿鐵咖啡",-1),we=e("option",{value:"espresso"},"義式咖啡",-1),ze=e("option",{value:"tea"},"萃茶",-1),Ue=e("option",{value:"special"},"期間限定",-1),qe=[Se,we,ze,Ue],Ce={class:"dialog_container_right"},Me={class:"adminDialogBg_textareaStyle"},Ne=e("label",{for:"dialog_description"},"說明：",-1),$e={class:"adminDialogBg_image"},Fe=e("label",null,"商品圖片：",-1),Je=e("button",{class:"admin_button button_save",type:"submit"},"儲存",-1),Ie={__name:"ProductsView",setup(Le){const w=(l,s)=>l===0&&s!==0?"<L> "+s:l===0&&s===0?" ":l!==0&&s===0?"<M>"+l:"<M>"+l+"  <L>"+s,r={required(l){return!!l||"欄位必填"},price(l){return l>0||"價格錯誤"}},i=v([]),x=k(!1),t=v({_id:"",name:"",mprice:0,lprice:0,description:"",image:void 0,sell:!1,category:"",idx:-1,custom:{msize:!1,lsize:!1,ice:!1,hot:!1,sugar:!1,nosugar:!1}}),_=v({name:"",description:"",price:""});function h(l){_[l]=!0}const g=()=>{const l=document.querySelector(".darkDialogBg"),s=document.querySelector(".dialogBg");l.style.display="none",s.style.display="none"},V=l=>{l===-1?(t._id="",t.name="",t.mprice=0,t.lprice=0,t.description="",t.image=void 0,t.sell=!1,t.category="",k(!1),t.idx=-1,t.custom={msize:!1,lsize:!1,ice:!1,hot:!1,sugar:!1,nosugar:!1}):(t._id=i[l]._id,t.name=i[l].name,t.mprice=i[l].mprice,t.lprice=i[l].lprice,t.description=i[l].description,t.image=i[l].image,t.sell=i[l].sell,t.category=i[l].category,k(!1),t.idx=l,t.custom=i[l].custom?JSON.parse(i[l].custom):{msize:!1,lsize:!1,ice:!1,hot:!1,sugar:!1,nosugar:!1});for(const o in _)_[o]=!1;const s=document.querySelector(".darkDialogBg"),y=document.querySelector(".dialogBg");s.style.display="block",y.style.display="block"},z=async()=>{if(!x.value)return;const l=new FormData;t.custom.msize||(t.mprice=0),t.custom.lsize||(t.lprice=0),l.append("name",t.name),l.append("lprice",t.lprice),l.append("mprice",t.mprice),l.append("description",t.description),l.append("image",t.image),l.append("sell",t.sell),l.append("category",t.category),l.append("custom",JSON.stringify(t.custom));try{if(t._id.length===0){const{data:s}=await B.post("/products",l);i.push(s.result),f.fire({icon:"success",title:"成功",text:"新增成功"}),g()}else{const{data:s}=await B.patch("/products/"+t._id,l);i[t.idx]=s.result,f.fire({icon:"success",title:"成功",text:"編輯成功"}),g()}}catch(s){f.fire({icon:"error",title:"失敗",text:s?.response?.data?.message||"發生錯誤"})}};return(async()=>{try{const{data:l}=await B.get("/products/all");i.push(...l.result)}catch(l){f.fire({icon:"error",title:"失敗",text:l?.response?.data?.message||"發生錯誤"})}})(),(l,s)=>{const y=q("v-image-input");return c(),d(D,null,[e("div",F,[e("div",J,[L,e("button",{class:"admin_button button_add",onClick:s[0]||(s[0]=o=>V(-1))},[T,u(" 新增 ")])]),E]),e("div",I,[e("table",null,[O,e("tbody",null,[(c(!0),d(D,null,C(i,(o,U)=>(c(),d("tr",null,[e("td",P,n(o._id),1),e("td",j,n(o.name),1),e("td",A,n(w(o.mprice,o.lprice)),1),e("td",R,n(o.category),1),e("td",{class:"table_th_short",style:$(o.sell?"color:#52b96c;":"color:#e43939;")},n(o.sell?"上架":"下架"),5),e("td",G,[e("button",{class:"admin_button button_controll",onClick:Te=>V(U)},[K,u("修改")],8,H)])]))),256))])])]),e("div",Q,[e("form",{ref_key:"valid",ref:x,onSubmit:M(z,["prevent"])},[e("div",X,[u(n(t._id.length>0?"編輯商品":"新增商品")+" ",1),e("div",{class:"dialogClose",onClick:g},Z)]),e("div",ee,[e("div",te,[e("div",se,[e("div",le,[oe,e("div",ie,[a(e("input",{type:"text",id:"dialog_name","onUpdate:modelValue":s[1]||(s[1]=o=>t.name=o),onBlur:s[2]||(s[2]=o=>h("name"))},null,544),[[b,t.name]]),_.name&&r.required(t.name)!==!0?(c(),d("p",ae,n(r.required(t.name)),1)):p("",!0)])]),e("div",ne,[re,e("label",null,[a(e("input",{type:"checkbox","onUpdate:modelValue":s[3]||(s[3]=o=>t.custom.lsize=o)},null,512),[[m,t.custom.lsize]]),u("大杯")]),e("label",null,[a(e("input",{type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=o=>t.custom.msize=o)},null,512),[[m,t.custom.msize]]),u("中杯")]),e("label",null,[a(e("input",{type:"checkbox","onUpdate:modelValue":s[5]||(s[5]=o=>t.custom.ice=o)},null,512),[[m,t.custom.ice]]),u("冰")]),e("label",null,[a(e("input",{type:"checkbox","onUpdate:modelValue":s[6]||(s[6]=o=>t.custom.hot=o)},null,512),[[m,t.custom.hot]]),u("熱")]),e("label",null,[a(e("input",{type:"checkbox","onUpdate:modelValue":s[7]||(s[7]=o=>t.custom.sugar=o)},null,512),[[m,t.custom.sugar]]),u("全糖")]),e("label",null,[a(e("input",{type:"checkbox","onUpdate:modelValue":s[8]||(s[8]=o=>t.custom.nosugar=o)},null,512),[[m,t.custom.nosugar]]),u("無糖")])]),t.custom.lsize?(c(),d("div",ce,[de,e("div",ue,[a(e("input",{type:"number",id:"dialog_price","onUpdate:modelValue":s[9]||(s[9]=o=>t.lprice=o),onBlur:s[10]||(s[10]=o=>h("price"))},null,544),[[b,t.lprice]]),_.price&&r.required(t.lprice)!==!0?(c(),d("p",_e,n(r.required(t.lprice)),1)):p("",!0),_.price&&r.price(t.lprice)!==!0?(c(),d("p",pe,n(r.price(t.lprice)),1)):p("",!0)])])):p("",!0),t.custom.msize?(c(),d("div",me,[ge,e("div",he,[a(e("input",{type:"number",id:"dialog_price","onUpdate:modelValue":s[11]||(s[11]=o=>t.mprice=o),onBlur:s[12]||(s[12]=o=>h("price"))},null,544),[[b,t.mprice]]),_.price&&r.required(t.mprice)!==!0?(c(),d("p",fe,n(r.required(t.mprice)),1)):p("",!0),_.price&&r.price(t.mprice)!==!0?(c(),d("p",be,n(r.price(t.mprice)),1)):p("",!0)])])):p("",!0),e("div",ye,[ve,a(e("select",{id:"dialog_select_sell","onUpdate:modelValue":s[13]||(s[13]=o=>t.sell=o)},xe,512),[[S,t.sell]])]),e("div",Ve,[De,a(e("select",{id:"dialog_select_category","onUpdate:modelValue":s[14]||(s[14]=o=>t.category=o)},qe,512),[[S,t.category]])])]),e("div",Ce,[e("div",Me,[Ne,a(e("textarea",{id:"dialog_description",rows:"10","onUpdate:modelValue":s[15]||(s[15]=o=>t.description=o),onBlur:s[16]||(s[16]=o=>h("description"))},null,544),[[b,t.description]])]),e("div",$e,[Fe,N(y,{modelValue:t.image,"onUpdate:modelValue":s[17]||(s[17]=o=>t.image=o),"max-file-size":1,removable:""},null,8,["modelValue"])])])]),e("div",{class:"dialog_btn_container"},[e("button",{class:"admin_button button_close",onClick:g},"取消"),Je])])],40,W)]),e("div",{class:"darkDialogBg",onClick:g})],64)}}};export{Ie as default};
