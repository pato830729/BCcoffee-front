import{o as O,r as m,a as J,b as x,k as w,S as $,c as i,d as a,l as U,e as s,w as q,f as v,v as h,h as d,F as y,m as S,_ as A,t as r,n as L,i as D}from"./index-8da19006.js";const M={id:"container"},T={class:"pageTitle"},z=s("span",null,"ACCONT",-1),B=s("h1",null,"會員資料",-1),E={id:"sort"},P={class:"sort_box"},j=s("div",{class:"sort_linebox"},[s("div",{class:"sort_lineFocus"}),s("div",{class:"sort_line"})],-1),I={key:0,class:"profile_container"},G=["onSubmit"],H={class:"text_area"},K={class:"label_position"},Q=s("label",{class:"text_label"},"姓名：",-1),R={class:"label_position"},W=s("label",{class:"text_label"},"信箱：",-1),X={class:"label_position"},Y=s("label",{class:"text_label"},"手機號碼：",-1),Z={class:"label_position"},ss=s("label",{class:"text_label"},"地址：",-1),es=s("div",{class:"contant_btn"},[s("button",{type:"submit"},"儲存")],-1),ts={key:1,class:"password_container"},os=D('<div class="text_area"><input type="text" placeholder="請輸入您的舊密碼"><input type="text" placeholder="請再次輸入您的舊密碼"><input type="text" placeholder="請輸入您的新密碼"></div><div class="contant_btn"><div>修改</div></div>',2),ls=[os],ns={key:2,class:"order_container"},is=s("div",{class:"search_container"},[s("input",{type:"text",placeholder:"以訂單編號搜尋"}),s("button",null,"搜尋")],-1),as={class:"shoppingForm_table"},cs=s("div",{class:"shoppingForm_title"},[s("div",null,"訂單編號"),s("div",null,"日期"),s("div",null,"金額"),s("div",null,"詳細資訊")],-1),ds=["onClick"],rs={key:1,class:"account_popup"},us={class:"popup_person"},_s={class:"popup_productsall"},ps={key:0},vs={key:1},hs={key:2},ms={key:3},ys={key:4},fs={key:5},gs={__name:"AccountView",setup(bs){O(()=>{const t=document.querySelectorAll(".sort_item"),o=document.querySelector(".sort_lineFocus"),e=100/t.length;for(let n=0;n<t.length;n++)t[0].style.color="#fc9f4d",t[n].style.width=`${e}%`,t[n].addEventListener("click",()=>{o.style.transition="all .5s ease",o.style.left=`${e*n}%`,t[n].style.color="#fc9f4d";const c=Array.from(t).filter(_=>_!==t[n]);for(let _=0;_<c.length;_++)c[_].style.color="#a35e47"});o.style.width=`${e}%`});const u=m(1),p=m(-1),N=t=>{p.value=t},f=()=>{p.value=-1},b=t=>{t==="profileinfo"?(u.value=1,console.log(t)):t==="password"?u.value=2:(u.value=3,console.log(t))},k=m(!1),V=J(),{editUserInfo:C}=V,F=()=>{k.value&&C({name:l.name,address:l.address,email:l.email,phone:l.phone})},l=x({name:"",address:"",email:"",phone:"",_id:""});(async()=>{const{data:t}=await w.get("/users/me");l.name=t.result.name,l.address=t.result.address,l.email=t.result.email,l.phone=t.result.phone,l._id=t.result.phone})();const g=x([]);return(async()=>{try{const{data:t}=await w.get("/orders");g.push(...t.result.map(o=>(o.totalPrice=o.products.reduce((e,n)=>JSON.parse(n.custom).size=="L"?e+n.p_id.lprice*n.quantity:e+n.p_id.mprice*n.quantity,0),o)))}catch{$.fire({icon:"error",title:"失敗",text:"取得訂單失敗"})}})(),(t,o)=>(i(),a(y,null,[U(A),s("div",M,[s("div",T,[z,B,s("div",E,[s("ul",P,[s("li",{class:"sort_item",onClick:o[0]||(o[0]=e=>b("profileinfo"))},"會員資料"),s("li",{class:"sort_item",onClick:o[1]||(o[1]=e=>b("order"))},"訂單查詢")]),j])]),u.value===1?(i(),a("div",I,[s("form",{ref_key:"valid",ref:k,onSubmit:q(F,["prevent"])},[s("div",H,[s("div",K,[Q,v(s("input",{type:"text","onUpdate:modelValue":o[2]||(o[2]=e=>l.name=e)},null,512),[[h,l.name]])]),s("div",R,[W,v(s("input",{type:"text","onUpdate:modelValue":o[3]||(o[3]=e=>l.email=e)},null,512),[[h,l.email]])]),s("div",X,[Y,v(s("input",{type:"text","onUpdate:modelValue":o[4]||(o[4]=e=>l.phone=e)},null,512),[[h,l.phone]])]),s("div",Z,[ss,v(s("input",{type:"text","onUpdate:modelValue":o[5]||(o[5]=e=>l.address=e)},null,512),[[h,l.address]])])]),es],40,G)])):d("",!0),u.value===2?(i(),a("div",ts,ls)):d("",!0),u.value===3?(i(),a("div",ns,[is,s("div",as,[cs,(i(!0),a(y,null,S(g,(e,n)=>(i(),a("div",{class:"shoppingForm_info",key:e._id},[s("div",null,r(e._id),1),s("div",null,r(new Date(e.date).toLocaleDateString()),1),s("div",null,r(e.totalPrice),1),s("div",null,[s("button",{onClick:c=>N(n)},"詳細資訊",8,ds)]),p.value==n?(i(),a("div",{key:0,class:"account_popup_background",onClick:f})):d("",!0),p.value==n?(i(),a("div",rs,[s("div",{class:"popup_title"},[L(" 詳細資料"),s("i",{class:"fa-solid fa-xmark",onClick:f})]),s("div",us,[s("p",null,"收貨人姓名："+r(e.name),1),s("p",null,"收貨人電話："+r(e.phone),1),s("p",null,"收貨人地址："+r(e.address),1),s("p",null,"付款方式："+r(e.payway=="cash"?"貨到付款":"線上刷卡"),1)]),s("div",_s,[(i(!0),a(y,null,S(e.products,c=>(i(),a("div",{class:"popup_products",key:c._id},[s("span",null,r(c.p_id.name),1),JSON.parse(c.custom).size=="M"?(i(),a("span",ps,"-中杯")):d("",!0),JSON.parse(c.custom).size=="L"?(i(),a("span",vs,"-大杯")):d("",!0),JSON.parse(c.custom).ice=="ice"?(i(),a("span",hs,"-冰")):d("",!0),JSON.parse(c.custom).ice=="hot"?(i(),a("span",ms,"-熱")):d("",!0),JSON.parse(c.custom).sugar=="sugar"?(i(),a("span",ys,"-全糖")):d("",!0),JSON.parse(c.custom).sugar=="nosugar"?(i(),a("span",fs,"-無糖")):d("",!0),s("span",null," *"+r(c.quantity),1)]))),128))])])):d("",!0)]))),128))])])):d("",!0)])],64))}};export{gs as default};
