import{a as I,b as y,r as C,G as F,c as a,d as c,l as H,e,F as w,m as U,t as l,H as g,n as f,h as u,w as A,f as d,I as G,v as h,E as N,J as O,i as x,k as P,S as K,_ as R}from"./index-8da19006.js";const j={id:"container"},Q=x('<div class="pageTitle"><span>CHECKOUT</span><h1>結帳</h1></div><div class="processStep_container"><div class="processStep_circle_container"><div class="processStep_circle step1 circle_on">1 <div class="circletext1">購物車資料</div></div><div class="processStep_circle step2">2 <div class="circletext2">付款資料</div></div><div class="processStep_circle step3">3 <div class="circletext3">訂單確認</div></div></div><div class="processStep_line_container"><div class="processStep_line_gary"></div><div class="processStep_line_done"></div></div></div>',2),W={key:0,class:"processStep1_container"},X=e("h1",null,"購物車資料",-1),Y={class:"products_discount_display"},Z={class:"allproducts_container"},ee={class:"product_img"},te=["src"],oe={class:"product_text"},se={class:"product_title_custom"},ne={class:"cart_product_title_delete"},ie={class:"cart_product_allcustom"},le={key:0},ae={key:1},ce={key:2},de={key:3},re={key:4},ue={key:5},_e={class:"cart_controllnum_titleprice"},pe={class:"cart_controllnum"},ve=["onClick"],he=e("i",{class:"fa-solid fa-minus"},null,-1),me=[he],ye=["onUpdate:modelValue"],fe=["onClick"],be=e("i",{class:"fa-solid fa-plus"},null,-1),Se=[be],ke=["onClick"],we={class:"titlepriceDiscount_container"},ge={class:"total_container"},xe={class:"total_checkout"},qe={class:"total_text"},Ve={class:"totalPrice"},Ce=e("p",null,"商品金額",-1),Ue={class:"discountTotalPrice"},Ne=e("p",null,"訂單總金額",-1),Oe=["disabled"],Pe=e("i",{class:"fa-solid fa-credit-card"},null,-1),$e={key:1,class:"processStep2_container"},Je=e("h1",null,"付款資料",-1),Le=["onSubmit"],Me={class:"paycontainer"},Te={class:"leftcontainer"},ze={class:"samecheckbox"},Be=e("p",null,"訂購人資料",-1),De={for:"memberInfo"},Ee={class:"input_container"},Ie=e("label",{for:"pay_name"},"姓名：",-1),Fe={class:"input_container"},He=e("label",{for:"pay_phone"},"手機：",-1),Ae={class:"input_container"},Ge=e("label",{for:"address"},"地址：",-1),Ke={class:"rightcontainer"},Re={class:"radio_container"},je=e("label",{for:"radioPay_online"},"付款方式：",-1),Qe={class:"radio_choosebox"},We=e("label",{for:"radioPay_online"},[e("span"),f("取貨付款")],-1),Xe=e("label",{for:"radioPay_cash"},[e("span"),f("線上付款")],-1),Ye={key:0,class:"card_container"},Ze={class:"input_container"},et=e("label",{for:"pay_phone"},"信用卡號：",-1),tt={class:"cardnum4"},ot=e("span",null,"-",-1),st=e("span",null,"-",-1),nt=e("span",null,"-",-1),it={class:"input_container"},lt=e("label",{for:"pay_phone"},"卡片期限：",-1),at=x('<option value="" disabled selected>年份</option><option value="23">2023</option><option value="24">2024</option><option value="25">2025</option><option value="26">2026</option><option value="27">2027</option><option value="28">2028</option><option value="29">2029</option><option value="30">2030</option><option value="31">2031</option><option value="32">2032</option><option value="33">2033</option><option value="34">2034</option>',13),ct=[at],dt=x('<option value="" disabled selected>月份</option><option value="01">1</option><option value="02">2</option><option value="03">3</option><option value="04">4</option><option value="05">5</option><option value="06">6</option><option value="07">7</option><option value="08">8</option><option value="09">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option>',13),rt=[dt],ut=e("div",{class:"input_container"},[e("label",{for:"pay_phone"},"認證號："),e("div",{class:"cardnum4"},[e("input",{type:"number",oninput:"if(value.length>3)value=value.slice(0,3)"})])],-1),_t={class:"card_allcard"},pt={class:"back"},vt={class:"allcard_cardnum"},ht={class:"allcard_month"},mt=e("span",null,"/",-1),yt={class:"btn_container"},ft=e("button",{class:"payment_btn",type:"submit"},"下一步",-1),bt={key:2,class:"processStep3_container"},St=e("h1",null,"訂單完成!",-1),kt=e("h3",null,"謝謝您的訂購，我們會盡快完成您的訂單。",-1),wt={class:"cart_display"},gt={class:"cart_info"},xt={class:"cartinfo_products_container"},qt=e("div",{class:"cartinfo_products_container_title"},"訂單商品清單",-1),Vt={class:"cartinfo_products_container_products"},Ct={class:"product_img"},Ut=["src"],Nt={class:"cart_product_title"},Ot={class:"cart_product_quantity"},Pt=e("div",{class:"cartinfo_products_container_price"},null,-1),Lt={__name:"OrderCheckOutView",setup($t){const $=I(),{editCart:J,checkout:L}=$,r=y([]),m=C(1),q=C(!1),s=y({name:"",phone:"",address:"",payway:"",write:!1}),M=()=>{s.write&&(console.log(p),s.name=p.name,s.phone=p.phone,s.address=p.address)},T=()=>{q.value&&(console.log(123),L({name:s.name,phone:s.phone,address:s.address,payway:s.payway}),z())},V=n=>{const o=document.querySelector(".step1"),t=document.querySelector(".step2"),v=document.querySelector(".step3"),_=document.querySelector(".circletext1"),E=document.querySelector(".circletext2");document.querySelector(".circletext3");const k=document.querySelector(".processStep_line_done");n==="cart"?(m.value=1,o.style.background="white",o.style.color="#fc9f4d",_.style.color="#fc9f4d",k.style.width="0px",t.classList.remove("circle_on")):n==="checkout"?(m.value=2,o.style.background="#fc9f4d",o.style.color="white",_.style.color="#fc9f4d",t.classList.add("circle_on"),k.style.width="400px"):(m.value=3,o.style.background="#fc9f4d",o.style.color="white",t.style.background="#fc9f4d",t.style.color="white",E.style.color="#fc9f4d",v.classList.add("circle_on"),k.style.width="800px")},z=()=>{const n=document.querySelector(".step1"),o=document.querySelector(".step2"),t=document.querySelector(".step3");document.querySelector(".circletext1");const v=document.querySelector(".circletext2");document.querySelector(".circletext3");const _=document.querySelector(".processStep_line_done");m.value=3,n.style.background="#fc9f4d",n.style.color="white",o.style.background="#fc9f4d",o.style.color="white",v.style.color="#fc9f4d",t.classList.add("circle_on"),_.style.width="800px"},i=y({onlinepay:!1,num1:"",num2:"",num3:"",num4:"",year:"",month:""}),b=async(n,o)=>{await J({_id:r[n].p_id._id,quantity:o,custom:r[n].custom,showPu:!1}),r[n].quantity+=o,r[n].quantity<=0&&r.splice(n,1)},B=async()=>{try{r.length=0;const{data:n}=await P.get("/users/cart");r.push(...n.result)}catch{K.fire({icon:"error",title:"失敗",text:"取得購物車失敗"})}},S=F(()=>r.reduce((n,o)=>JSON.parse(o.custom).size=="L"?n+o.p_id.lprice*o.quantity:n+o.p_id.mprice*o.quantity,0)),p=y({name:"",address:"",email:"",phone:""}),D=async()=>{const{data:n}=await P.get("/users/me");p.name=n.result.name,p.address=n.result.address,p.email=n.result.email,p.phone=n.result.phone};return B(),D(),(n,o)=>(a(),c(w,null,[H(R),e("div",j,[Q,m.value===1?(a(),c("div",W,[X,e("div",Y,[e("div",Z,[(a(!0),c(w,null,U(r,(t,v)=>(a(),c("div",{class:"product_container",key:t._id},[e("div",ee,[e("img",{src:t.p_id.image},null,8,te)]),e("div",oe,[e("div",se,[e("div",ne,l(t.p_id.name),1),e("div",ie,[JSON.parse(t.custom).size=="M"?(a(),c("span",le,"-中杯")):u("",!0),JSON.parse(t.custom).size=="L"?(a(),c("span",ae,"-大杯")):u("",!0),JSON.parse(t.custom).ice=="ice"?(a(),c("span",ce,"-冰")):u("",!0),JSON.parse(t.custom).ice=="hot"?(a(),c("span",de,"-熱")):u("",!0),JSON.parse(t.custom).sugar=="sugar"?(a(),c("span",re,"-全糖")):u("",!0),JSON.parse(t.custom).sugar=="nosugar"?(a(),c("span",ue,"-無糖")):u("",!0)])]),e("div",_e,[e("div",pe,[e("div",{class:"cart_controllbtn",onClick:_=>b(v,-1)},me,8,ve),d(e("input",{type:"number","onUpdate:modelValue":_=>t.quantity=_},null,8,ye),[[h,t.quantity]]),e("div",{class:"cart_controllbtn",onClick:_=>b(v,1)},Se,8,fe)])]),e("i",{class:"fa-solid fa-trash-can",onClick:_=>b(v,t.quantity*-1)},null,8,ke)])]))),128))]),e("div",we,[e("div",ge,[e("div",xe,[e("div",qe,[e("div",Ve,[Ce,e("span",null,"$"+l(g(S)),1)])]),e("div",Ue,[Ne,e("span",null,"$"+l(g(S)),1)])]),e("button",{class:"checkout",onClick:o[0]||(o[0]=t=>V("checkout")),disabled:n.canCheckout},[Pe,f("結帳 ")],8,Oe)])])])])):u("",!0),m.value===2?(a(),c("div",$e,[Je,e("form",{ref_key:"valid",ref:q,onSubmit:A(T,["prevent"])},[e("div",Me,[e("div",Te,[e("div",ze,[Be,e("label",De,[d(e("input",{type:"checkbox",id:"memberInfo",onChange:o[1]||(o[1]=t=>M()),"onUpdate:modelValue":o[2]||(o[2]=t=>s.write=t)},null,544),[[G,s.write]]),f("同會員資料")])]),e("div",Ee,[Ie,d(e("input",{type:"text",id:"pay_name",placeholder:"請輸入您的姓名","onUpdate:modelValue":o[3]||(o[3]=t=>s.name=t)},null,512),[[h,s.name]])]),e("div",Fe,[He,d(e("input",{type:"text",id:"pay_phone",placeholder:"請輸入您的手機號碼","onUpdate:modelValue":o[4]||(o[4]=t=>s.phone=t)},null,512),[[h,s.phone]])]),e("div",Ae,[Ge,d(e("input",{type:"text",id:"address",placeholder:"請輸入您的地址","onUpdate:modelValue":o[5]||(o[5]=t=>s.address=t)},null,512),[[h,s.address]])])]),e("div",Ke,[e("div",Re,[je,e("div",Qe,[d(e("input",{type:"radio",name:"radio_pay",id:"radioPay_online",value:"cash","onUpdate:modelValue":o[6]||(o[6]=t=>s.payway=t)},null,512),[[N,s.payway]]),We,d(e("input",{type:"radio",name:"radio_pay",id:"radioPay_cash",value:"online","onUpdate:modelValue":o[7]||(o[7]=t=>s.payway=t)},null,512),[[N,s.payway]]),Xe])]),s.payway=="online"?(a(),c("div",Ye,[e("div",Ze,[et,e("div",tt,[d(e("input",{type:"number",oninput:"if(value.length>4)value=value.slice(0,3);","onUpdate:modelValue":o[8]||(o[8]=t=>i.num1=t)},null,512),[[h,i.num1]]),ot,d(e("input",{type:"number",oninput:"if(value.length>4)value=value.slice(0,3)","onUpdate:modelValue":o[9]||(o[9]=t=>i.num2=t)},null,512),[[h,i.num2]]),st,d(e("input",{type:"number",oninput:"if(value.length>4)value=value.slice(0,3)","onUpdate:modelValue":o[10]||(o[10]=t=>i.num3=t)},null,512),[[h,i.num3]]),nt,d(e("input",{type:"number",oninput:"if(value.length>4)value=value.slice(0,3)","onUpdate:modelValue":o[11]||(o[11]=t=>i.num4=t)},null,512),[[h,i.num4]])])]),e("div",it,[lt,d(e("select",{name:"",id:"","onUpdate:modelValue":o[12]||(o[12]=t=>i.year=t)},ct,512),[[O,i.year]]),d(e("select",{name:"",id:"","onUpdate:modelValue":o[13]||(o[13]=t=>i.month=t)},rt,512),[[O,i.month]])]),ut,e("div",_t,[e("div",pt,[e("div",vt,[e("span",null,l(i.num1),1),e("span",null,l(i.num2),1),e("span",null,l(i.num3),1),e("span",null,l(i.num4),1)]),e("div",ht,[e("span",null,l(i.year),1),mt,e("span",null,l(i.month),1)])])])])):u("",!0)])]),e("div",yt,[e("button",{class:"payment_btn",onClick:o[14]||(o[14]=t=>V("cart"))},"上一步"),ft])],40,Le)])):u("",!0),m.value===3?(a(),c("div",bt,[St,kt,e("div",wt,[e("div",gt,[e("p",null,"姓名："+l(s.name),1),e("p",null,"手機："+l(s.phone),1),e("p",null,"地址："+l(s.address),1),e("p",null,"付款方式："+l(s.payway=="cash"?"貨到付款":"線上付款"),1),e("p",null,"訂單金額："+l(g(S)),1)]),e("div",xt,[qt,e("div",Vt,[(a(!0),c(w,null,U(r,(t,v)=>(a(),c("div",{class:"cartinfo_products_container_product",key:t._id},[e("div",Ct,[e("img",{src:t.p_id.image},null,8,Ut)]),e("div",Nt,l(t.p_id.name),1),e("div",Ot," ×"+l(t.quantity),1)]))),128))]),Pt])])])):u("",!0)])],64))}};export{Lt as default};
